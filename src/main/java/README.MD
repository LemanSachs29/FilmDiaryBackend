# FilmDiary - AplicaciÃ³n de Diario de PelÃ­culas

## ğŸ“‹ DescripciÃ³n del Proyecto

FilmDiary es una aplicaciÃ³n web completa para llevar un registro personal de pelÃ­culas vistas y por ver. Integra con la API de TMDB para bÃºsqueda de pelÃ­culas y permite a los usuarios crear su diario personal y watchlist.

## ğŸ—ï¸ Arquitectura

- **Backend**: Spring Boot + MariaDB + JWT + IntegraciÃ³n TMDB
- **Frontend**: HTML + Bootstrap 5 + JavaScript vanilla (pÃ¡ginas tradicionales)

## ğŸ“ Estructura del Proyecto

```
film-diary-backend/
â”œâ”€â”€ src/                          # CÃ³digo Java Spring Boot
â”œâ”€â”€ frontend/                     # AplicaciÃ³n web frontend
â”‚   â”œâ”€â”€ index.html               # âœ… Login/Registro (FUNCIONANDO)
â”‚   â”œâ”€â”€ dashboard.html           # âœ… Dashboard principal (FUNCIONANDO)
â”‚   â”œâ”€â”€ search.html              # âœ… BÃºsqueda de pelÃ­culas (FUNCIONANDO)
â”‚   â”œâ”€â”€ movie-detail.html        # âœ… Detalles de pelÃ­cula (FUNCIONANDO)
â”‚   â”œâ”€â”€ diary.html               # ğŸš§ Diario con tabla (PENDIENTE)
â”‚   â”œâ”€â”€ watchlist.html           # ğŸš§ Lista de pelÃ­culas por ver (PENDIENTE)
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ styles.css           # âœ… Estilos personalizados
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ api.js               # âœ… Clase para comunicaciÃ³n con backend
â”‚   â”‚   â”œâ”€â”€ auth.js              # âœ… Login/registro (index.html)
â”‚   â”‚   â”œâ”€â”€ dashboard.js         # âœ… Dashboard
â”‚   â”‚   â”œâ”€â”€ search.js            # âœ… BÃºsqueda pelÃ­culas
â”‚   â”‚   â”œâ”€â”€ movie-detail.js      # âœ… Detalles pelÃ­cula
â”‚   â”‚   â”œâ”€â”€ diary.js             # ğŸš§ Diario (PENDIENTE)
â”‚   â”‚   â””â”€â”€ watchlist.js         # ğŸš§ Watchlist (PENDIENTE)
```

## ğŸš€ Estado del Desarrollo

### âœ… COMPLETADO Y FUNCIONANDO

#### Backend (100% completo)
- âœ… AutenticaciÃ³n JWT
- âœ… IntegraciÃ³n TMDB completa
- âœ… CRUD Diario y Watchlist
- âœ… Validaciones y manejo de errores
- âœ… CORS configurado correctamente

#### Frontend (70% completo)
- âœ… **index.html + auth.js** - Login/registro con validaciones, guarda datos del usuario automÃ¡ticamente
- âœ… **dashboard.html + dashboard.js** - PÃ¡gina principal con Ãºltima pelÃ­cula vista, preview watchlist, navegaciÃ³n
- âœ… **search.html + search.js** - BÃºsqueda en TMDB con paginaciÃ³n, solo botÃ³n "Ver Detalles" 
- âœ… **movie-detail.html + movie-detail.js** - PÃ¡gina completa de detalles con:
  - InformaciÃ³n completa de pelÃ­cula (poster, sinopsis, gÃ©neros, duraciÃ³n, etc.)
  - BotÃ³n "AÃ±adir al Diario" con modal (fecha + rating estrellas interactivo)
  - BotÃ³n "AÃ±adir a Watchlist" 
  - Toasts de notificaciÃ³n
  - Manejo de estados y errores
- âœ… **api.js** - Clase completamente integrada que maneja automÃ¡ticamente el usuario logueado
- âœ… **styles.css** - Estilos personalizados con Bootstrap 5

### ğŸš§ PENDIENTE

- ğŸš§ **diary.html + diary.js** - Tabla paginada de pelÃ­culas vistas + modal de ediciÃ³n
- ğŸš§ **watchlist.html + watchlist.js** - Grid de pelÃ­culas por ver + eliminar/mover al diario

## ğŸ”Œ API Endpoints (Backend)

### AutenticaciÃ³n
- `POST /api/auth/login` - Iniciar sesiÃ³n (devuelve token + datos usuario)
- `POST /api/auth/register` - Registrar usuario (devuelve token + datos usuario)

### BÃºsqueda de PelÃ­culas  
- `GET /api/movies/search?query={query}&page={page}` - Buscar pelÃ­culas en TMDB
- `GET /api/movies/{movieId}` - Detalles de pelÃ­cula especÃ­fica

### Diario Personal
- `GET /api/diario?usuarioId={id}&page={page}&size={size}` - Obtener diario paginado
- `POST /api/diario/tmdb/{tmdbId}?usuarioId={id}&puntuacion={rating}&fechaVisionado={date}` - AÃ±adir pelÃ­cula al diario
- `PUT /api/diario/{entryId}?fechaVisionado={date}&puntuacion={rating}` - Actualizar entrada
- `DELETE /api/diario/{entryId}` - Eliminar entrada
- `GET /api/diario/{entryId}` - Obtener entrada especÃ­fica

### Watchlist
- `GET /api/watchlist?usuarioId={id}&page={page}&size={size}` - Obtener watchlist paginada
- `POST /api/watchlist/tmdb/{tmdbId}?usuarioId={id}` - AÃ±adir pelÃ­cula a watchlist
- `DELETE /api/watchlist/{peliculaId}?usuarioId={id}` - Eliminar de watchlist
- `GET /api/watchlist/check/{peliculaId}?usuarioId={id}` - Verificar si estÃ¡ en watchlist
- `GET /api/watchlist/count?usuarioId={id}` - Contar pelÃ­culas en watchlist

## ğŸ”§ ConfiguraciÃ³n y Setup

### Requisitos
- Java 17+
- MariaDB
- API Key de TMDB
- Python 3 (para servir frontend) o servidor web

### Variables de Entorno
```bash
export TMDB_API_KEY="tu_api_key_de_tmdb"
```

### Base de Datos
MariaDB con esquemas: `usuario`, `pelicula`, `usuario_diario`, `usuario_watchlist`

### Ejecutar Backend
```bash
cd film-diary-backend
./mvnw spring-boot:run
```

### Ejecutar Frontend
```bash
cd frontend
python3 -m http.server 3000
# Abrir: http://localhost:3000
```

## ğŸš€ Flujo de Usuario (Funcionando)

1. **Login/Registro** (`index.html`) â†’ Token JWT + datos usuario almacenados automÃ¡ticamente
2. **Dashboard** (`dashboard.html`) â†’ Vista general personalizada + navegaciÃ³n
3. **BÃºsqueda** (`search.html`) â†’ Encontrar pelÃ­culas â†’ "Ver Detalles"
4. **Detalles** (`movie-detail.html`) â†’ Ver info completa â†’ AÃ±adir a diario/watchlist
5. **Diario** (`diary.html`) â†’ ğŸš§ PENDIENTE - Gestionar pelÃ­culas vistas
6. **Watchlist** (`watchlist.html`) â†’ ğŸš§ PENDIENTE - Gestionar pelÃ­culas por ver

## ğŸ’¡ CaracterÃ­sticas Implementadas

### AutenticaciÃ³n AutomÃ¡tica
- El frontend guarda automÃ¡ticamente los datos del usuario al login/registro
- Todos los mÃ©todos de API usan automÃ¡ticamente el usuario logueado: `api.getDiary()`, `api.addToWatchlist()`
- Logout limpia todo + redirecciÃ³n automÃ¡tica

### Funcionalidades Avanzadas
- **Rating con estrellas** interactivo (1-5 estrellas + texto descriptivo)
- **Sistema de notificaciones** con Bootstrap toasts
- **Estados de carga** y manejo de errores en todas las pÃ¡ginas
- **Formateo inteligente** (fechas en espaÃ±ol, dinero, duraciÃ³n "2h 30min")
- **Responsive design** completo con Bootstrap 5

### IntegraciÃ³n TMDB
- BÃºsqueda en tiempo real (800ms delay)
- Detalles completos de pelÃ­culas
- ImÃ¡genes optimizadas con placeholders
- PaginaciÃ³n funcional

## ğŸ”§ Problemas Resueltos

### âœ… CORS
- Configurado correctamente en `SecurityConfig.java`
- Permite desarrollo local (localhost:3000, localhost:8000)

### âœ… Manejo de Usuario
- AuthResponseDto devuelve datos completos del usuario
- Frontend guarda automÃ¡ticamente token + datos usuario
- API automÃ¡ticamente usa el usuario logueado

### âœ… IntegraciÃ³n Frontend-Backend
- api.js completamente funcional
- Manejo de errores consistente
- Estados de carga en todas las pÃ¡ginas

## ğŸ¯ URLs de Prueba

Una vez ejecutando:

### PÃ¡ginas principales
- `http://localhost:3000/index.html` - Login/registro
- `http://localhost:3000/dashboard.html` - Dashboard principal
- `http://localhost:3000/search.html` - BÃºsqueda de pelÃ­culas

### Detalles de pelÃ­culas (ejemplos)
- `http://localhost:3000/movie-detail.html?id=550` - Fight Club
- `http://localhost:3000/movie-detail.html?id=13` - Forrest Gump  
- `http://localhost:3000/movie-detail.html?id=122` - El SeÃ±or de los Anillos

## ğŸ“ Notas TÃ©cnicas

### Arquitectura API Frontend
```javascript
// Uso automÃ¡tico del usuario logueado:
await api.getDiary(0, 10);           // En lugar de api.getDiary(usuarioId, 0, 10)
await api.addToWatchlist(tmdbId);    // En lugar de api.addToWatchlist(usuarioId, tmdbId)
await api.getWatchlistCount();       // En lugar de api.getWatchlistCount(usuarioId)
```

### Manejo de Estados
- **LocalStorage**: Token JWT + datos usuario completos
- **Variables JS**: Datos temporales de la sesiÃ³n
- **Bootstrap Modals**: Para forms (aÃ±adir al diario)
- **Bootstrap Toasts**: Para notificaciones

### Validaciones
- Frontend: Email vÃ¡lido, contraseÃ±a segura, campos obligatorios
- Backend: Validaciones con anotaciones Spring + manejo de errores
- Fechas: No futuras para fecha de visionado
- Puntuaciones: 0-5 estrellas

## ğŸ¯ Siguiente Desarrollo

### Prioridad Alta
1. **diary.html + diary.js** - Tabla paginada con todas las pelÃ­culas vistas + modal de ediciÃ³n
2. **watchlist.html + watchlist.js** - Grid de pelÃ­culas por ver + eliminar/mover al diario

### Funcionalidades Avanzadas (Futuro)
- EstadÃ­sticas personales
- Exportar diario
- Recomendaciones basadas en historial
- Compartir listas

## ğŸ” Debugging

### Problemas Comunes
1. **CORS**: Verificar que frontend estÃ© en `http://localhost:3000` (no file://)
2. **API Key**: Verificar variable `TMDB_API_KEY` en backend
3. **Base de datos**: Verificar conexiÃ³n MariaDB en `application.yml`
4. **AutenticaciÃ³n**: Verificar token JWT en localStorage del navegador

### Logs Ãštiles
```bash
# Backend - Ver peticiones
tail -f logs/spring.log

# Frontend - Console del navegador
F12 â†’ Console â†’ Ver errores JavaScript
```

---

**Desarrollado con Spring Boot + Bootstrap 5 + JavaScript Vanilla**  
**IntegraciÃ³n TMDB para catÃ¡logo de pelÃ­culas**